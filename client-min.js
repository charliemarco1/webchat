var socket=io.connect("http://138.197.32.211:3000");new Vue({el:"#app",data:{connectedUsers:[],messages:[],message:{type:"",action:"",user:"",text:"",timestamp:""},areTyping:[]},created:function(){socket.on("user joined",function(e){axios.get("/onlineusers").then(function(e){for(var s in e.data)this.connectedUsers.indexOf(s)<=-1&&this.connectedUsers.push(s);console.log(this.connectedUsers)}.bind(this));var s={type:"info",msg:"User "+e+" has joined"};this.messages.push(s)}.bind(this)),socket.on("chat.message",function(e){this.messages.push(e)}.bind(this)),socket.on("user typing",function(e){this.areTyping.push(e)}.bind(this)),socket.on("stopped typing",function(e){var s=this.areTyping.indexOf(e);s>=0&&this.areTyping.splice(s,1)}.bind(this)),socket.on("user left",function(e){var s=this.connectedUsers.indexOf(e);s>=0&&this.connectedUsers.splice(s,1);var t={type:"info",msg:"User "+e+" has left"};this.messages.push(t)}.bind(this))},methods:{send:function(){this.message.type="chat",this.message.user=socket.id,this.message.timestamp=moment().calendar(),socket.emit("chat.message",this.message),this.message.type="",this.message.user="",this.message.text="",this.message.timestamp=""},userIsTyping:function(e){return this.areTyping.indexOf(e)>=0},usersAreTyping:function(){this.areTyping.indexOf(socket.id)<=-1&&(this.areTyping.push(socket.id),socket.emit("user typing",socket.id))},stoppedTyping:function(e){if("13"==e||"8"==e&&""==this.message.text){var s=this.areTyping.indexOf(socket.id);s>=0&&(this.areTyping.splice(s,1),socket.emit("stopped typing",socket.id))}}}});